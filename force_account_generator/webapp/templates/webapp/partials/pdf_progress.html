<div class="pdf-progress">
  <!-- STAGE 1 -->
  <div
    :class="{ 'active': stage === 1, 'completed': stage > 1 }"
    id="stage-1"
    x-show.transition.in.opacity.duration.300ms="stage >= 1"
  >
    <div class="step-icon">
      <svg viewBox="0 0 20 20" fill="currentColor" class="success-icon">
        <path
          fill-rule="evenodd"
          d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
          clip-rule="evenodd"
        ></path>
      </svg>
    </div>
    <div class="step-content" x-text="'Loading data from Excel file'"></div>
  </div>

  <!-- STAGE 2 -->
  <div
    :class="{ 'active': stage === 2, 'completed': stage > 2 }"
    id="stage-2"
    x-show.transition.in.opacity.duration.300ms="stage >= 1"
  >
    <div class="step-icon">
      <svg viewBox="0 0 20 20" fill="currentColor" class="success-icon">
        <path
          fill-rule="evenodd"
          d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
          clip-rule="evenodd"
        ></path>
      </svg>
    </div>
    <div class="step-content">
      <div class="progress-wrapper">
        <div class="progress-info">
          <span>Generating PDF pages</span>
          <div class="progress-info-size" x-show="stage >= 2">
            <div class="progress-completed-size" x-text="currentPage"></div>
            <span>/</span>
            <div class="progress-total-size" x-text="totalPages + ' pages'"></div>
          </div>
        </div>

        <div class="progress-bar" x-show="stage >= 2">
          <div
            :style="'width: ' + (currentPage/totalPages) * 100 + '%; background-color: ' + (stage >= 3 ? '#e2e8f0' : '#3182ce')"
          ></div>
        </div>
      </div>
    </div>
  </div>

  <!-- STAGE 3 -->
  <div
    :class="{ 'active': stage === 3, 'completed': stage > 3 }"
    id="stage-3"
    x-show.transition.in.opacity.duration.300ms="stage >= 1"
  >
    <div class="step-icon">
      <svg viewBox="0 0 20 20" fill="currentColor" class="success-icon">
        <path
          fill-rule="evenodd"
          d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
          clip-rule="evenodd"
        ></path>
      </svg>
    </div>
    <div class="step-content" x-text="'Saving PDF to file'"></div>
  </div>
</div>

<!-- PDF READY -->
<div class="completed-popup" x-show.transition.in.opacity.duration.1000ms="stage >= 4">
  <div class="refresh-button">
    <div @click="reset()">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
        ></path>
      </svg>
    </div>
  </div>
  <div class="pdf-ready">
    <span>Your PDF is ready!</span>
    <a class="button button-primary-inverse button-icon" :href="'packages/' + taskId">
      <svg viewBox="0 0 20 20" fill="currentColor">
        <path
          fill-rule="evenodd"
          d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
          clip-rule="evenodd"
        ></path>
      </svg>
      <span>Download PDF</span>
    </a>
  </div>
</div>
